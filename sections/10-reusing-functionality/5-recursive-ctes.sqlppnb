{"cells":[{"kind":2,"language":"SQL++","value":"WITH RECURSIVE cte AS (\r\n    SELECT 1 AS r\r\n    UNION\r\n    SELECT cte.r + 1 AS r FROM cte WHERE cte.r <= 5)\r\nSELECT RAW r FROM cte"},{"kind":2,"language":"SQL++","value":"CREATE COLLECTION test.samples.employees IF NOT EXISTS"},{"kind":2,"language":"SQL++","value":"INSERT INTO test.samples.employees (KEY, VALUE)\r\nVALUES (\"1\", { \"employee\": \"Steven King\" }),\r\n    (\"2\", { \"employee\": \"Neena Kochhar\", \"manager\": \"Steven King\" }),\r\n    (\"3\", { \"employee\": \"Lex De Haan\", \"manager\": \"Steven King\" }),\r\n    (\"4\", { \"employee\": \"Den Raphaely\", \"manager\": \"Steven King\" }),\r\n    (\"5\", { \"employee\": \"Adam Fripp\", \"manager\": \"Steven King\" }),\r\n    (\"6\", { \"employee\": \"Laura Bissot\", \"manager\": \"Adam Fripp\" }),\r\n    (\"7\", { \"employee\": \"Alexander Khoo\", \"manager\": \"Den Raphaely\" }),\r\n    (\"8\", { \"employee\": \"Shelli Baida\", \"manager\": \"Den Raphaely\" }),\r\n    (\"9\", { \"employee\": \"Alexander Hunold\", \"manager\": \"Lex De Haan\" }),\r\n    (\"10\", { \"employee\": \"Bruce Ernst\", \"manager\": \"Alexander Hunold\" }),\r\n    (\"11\", { \"employee\": \"Valli Pataballa\", \"manager\": \"Alexander Hunold\" }),\r\n    (\"12\", { \"employee\": \"Hermann Baer\", \"manager\": \"Neena Kochhar\" }),\r\n    (\"13\", { \"employee\": \"Shelley Higgins\", \"manager\": \"Neena Kochhar\" }),\r\n    (\"14\", { \"employee\": \"Nancy Greenberg\", \"manager\": \"Neena Kochhar\" }),\r\n    (\"15\", { \"employee\": \"Ismael Sciarra\", \"manager\": \"Nancy Greenberg\" }),\r\n    (\"16\", { \"employee\": \"Jose Manuel Urman\", \"manager\": \"Nancy Greenberg\" }),\r\n    (\"17\", { \"employee\": \"Luis Popp\", \"manager\": \"Nancy Greenberg\" })\r\nRETURNING *"},{"kind":2,"language":"SQL++","value":"SELECT employees.*\r\nFROM test.samples.employees"},{"kind":2,"language":"SQL++","value":"WITH RECURSIVE cte AS (\r\n    SELECT employee, employee full_path\r\n    FROM test.samples.employees\r\n    WHERE manager IS MISSING\r\n    UNION\r\n    SELECT e.employee, e.manager, cte.full_path || '.' || e.employee full_path\r\n    FROM test.samples.employees e JOIN cte ON e.manager = cte.employee)\r\nSELECT cte.*\r\nFROM cte"},{"kind":2,"language":"SQL++","value":"WITH RECURSIVE cte AS (\r\n    SELECT employee, employee full_path\r\n    FROM test.samples.employees\r\n    WHERE manager IS MISSING\r\n    UNION\r\n    SELECT e.employee, e.manager, cte.full_path || '.' || e.employee full_path\r\n    FROM test.samples.employees e JOIN cte ON e.manager = cte.employee)\r\nSELECT RAW REPEAT(' ', 3 * (ARRAY_LENGTH(SPLIT(full_path, '.')) - 1)) || employee\r\nFROM cte\r\nORDER BY cte.full_path"}]}