{"cells":[{"kind":2,"language":"SQL++","value":"SELECT m.employee,\r\n    IFNULL(ARRAY_AGG(e.employee), MISSING) subordinates\r\nFROM test.samples.employees e\r\n    RIGHT JOIN test.samples.employees m\r\n    ON e.manager = m.employee\r\nGROUP BY m.employee"},{"kind":2,"language":"SQL++","value":"SELECT RAW { m.employee: IFNULL(ARRAY_AGG(e.employee), []) }\r\nFROM test.samples.employees e\r\n    RIGHT JOIN test.samples.employees m\r\n    ON e.manager = m.employee\r\nGROUP BY m.employee"},{"kind":2,"language":"SQL++","value":"with cte as (\r\n    SELECT m.employee, IFNULL(ARRAY_AGG(e.employee), []) subordinates\r\n    FROM test.samples.employees e\r\n        RIGHT JOIN test.samples.employees m\r\n        ON e.manager = m.employee\r\n    GROUP BY m.employee)\r\nselect RAW OBJECT v.employee:v.subordinates FOR v IN cte END"}]}