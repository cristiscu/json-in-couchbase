{"cells":[{"kind":1,"language":"markdown","value":"see https://docs.couchbase.com/cloud/n1ql/n1ql-language-reference/nest.html\r\n"},{"kind":2,"language":"SQL++","value":"with persons as (\r\n    select p.* from [\r\n        { \"id\": 1, \"name\": 'John' },\r\n        { \"id\": 2, \"name\": 'Mary' },\r\n        { \"id\": 3, \"name\": 'Jack' }] p),\r\n\r\norders as (\r\n    select o.* from [\r\n        { \"total\": 100, \"pid\": 1 },\r\n        { \"total\": 200, \"pid\": 1 },\r\n        { \"total\": 150, \"pid\": 2 }] o)\r\n\r\nselect * from persons\r\nunion\r\nselect * from orders"},{"kind":2,"language":"SQL++","value":"with persons as (\r\n    select p.* from [\r\n        { \"id\": 1, \"name\": 'John' },\r\n        { \"id\": 2, \"name\": 'Mary' },\r\n        { \"id\": 3, \"name\": 'Jack' }] p),\r\n\r\norders as (\r\n    select o.* from [\r\n        { \"total\": 100, \"pid\": 1 },\r\n        { \"total\": 200, \"pid\": 1 },\r\n        { \"total\": 150, \"pid\": 2 }] o)\r\n\r\nselect persons.name, orders\r\nfrom persons\r\n    LEFT JOIN orders\r\n    ON persons.id = orders.pid\r\nwhere orders.pid is not missing"},{"kind":2,"language":"SQL++","value":"with persons as (\r\n    select p.* from [\r\n        { \"id\": 1, \"name\": 'John' },\r\n        { \"id\": 2, \"name\": 'Mary' },\r\n        { \"id\": 3, \"name\": 'Jack' }] p),\r\n\r\norders as (\r\n    select o.* from [\r\n        { \"total\": 100, \"pid\": 1 },\r\n        { \"total\": 200, \"pid\": 1 },\r\n        { \"total\": 150, \"pid\": 2 }] o)\r\n\r\nselect persons.name, orders\r\nfrom persons\r\n    LEFT NEST orders\r\n    ON persons.id = orders.pid"},{"kind":2,"language":"SQL++","value":"with persons as (\r\n    select p.* from [\r\n        { \"id\": 1, \"name\": 'John' },\r\n        { \"id\": 2, \"name\": 'Mary' },\r\n        { \"id\": 3, \"name\": 'Jack' }] p),\r\n\r\norders as (\r\n    select o.* from [\r\n        { \"total\": 100, \"pid\": 1 },\r\n        { \"total\": 200, \"pid\": 1 },\r\n        { \"total\": 150, \"pid\": 2 }] o)\r\n\r\nselect persons.name,\r\n    ARRAY o.total FOR o IN orders END as totals\r\nfrom persons\r\n    LEFT NEST orders\r\n    ON persons.id = orders.pid"}]}