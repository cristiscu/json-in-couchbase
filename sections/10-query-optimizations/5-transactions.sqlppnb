{"cells":[{"kind":1,"language":"markdown","value":"With no transaction"},{"kind":2,"language":"SQL++","value":"select b.title, b.price\r\nfrom test.samples.books b\r\nwhere b.title = \"Streamlit in Snowflake\""},{"kind":2,"language":"SQL++","value":"UPSERT INTO test.samples.books b (KEY, VALUE)\r\nVALUES (\"68\", { \"title\": \"Streamlit in Snowflake\", \"price\": 2.99 })\r\nRETURNING b.title, b.price"},{"kind":2,"language":"SQL++","value":"UPSERT INTO test.samples.books b (KEY, VALUE)\r\nVALUES (\"68\", { \"title\": \"Streamlit in Snowflake\", \"price\": 3.99 })\r\nRETURNING b.title, b.price"},{"kind":2,"language":"SQL++","value":"UPDATE test.samples.books b\r\nSET b.price = 4.99\r\nWHERE b.title = \"Streamlit in Snowflake\"\r\nRETURNING b.title, b.price"},{"kind":2,"language":"SQL++","value":"DELETE FROM test.samples.books b\r\nWHERE META().id = \"68\"\r\nRETURNING b.title, b.price"},{"kind":2,"language":"SQL++","value":"select b.title, b.price\r\nfrom test.samples.books b\r\nwhere b.title = \"Streamlit in Snowflake\""},{"kind":1,"language":"markdown","value":"With transaction"},{"kind":2,"language":"SQL++","value":"BEGIN TRANSACTION"},{"kind":2,"language":"SQL++","value":"SET TRANSACTION ISOLATION LEVEL READ COMMITTED"},{"kind":2,"language":"SQL++","value":"select t.*\r\nfrom system:transactions t"},{"kind":2,"language":"SQL++","value":"UPSERT INTO test.samples.books b (KEY, VALUE)\r\nVALUES (\"68\", { \"title\": \"Streamlit in Snowflake\", \"price\": 2.99 })\r\nRETURNING b.title, b.price"},{"kind":2,"language":"SQL++","value":"SAVEPOINT price_299"},{"kind":2,"language":"SQL++","value":"UPSERT INTO test.samples.books b (KEY, VALUE)\r\nVALUES (\"68\", { \"title\": \"Streamlit in Snowflake\", \"price\": 3.99 })\r\nRETURNING b.title, b.price"},{"kind":2,"language":"SQL++","value":"SAVEPOINT price_399"},{"kind":2,"language":"SQL++","value":"UPDATE test.samples.books b\r\nSET b.price = 4.99\r\nWHERE b.title = \"Streamlit in Snowflake\"\r\nRETURNING b.title, b.price"},{"kind":2,"language":"SQL++","value":"ROLLBACK TO SAVEPOINT price_399"},{"kind":2,"language":"SQL++","value":"select b.title, b.price\r\nfrom test.samples.books b\r\nwhere b.title = \"Streamlit in Snowflake\""},{"kind":2,"language":"SQL++","value":"COMMIT"},{"kind":2,"language":"SQL++","value":"select b.title, b.price\r\nfrom test.samples.books b\r\nwhere b.title = \"Streamlit in Snowflake\""},{"kind":2,"language":"SQL++","value":"select t.*\r\nfrom system:transactions t"},{"kind":2,"language":"SQL++","value":"DELETE FROM test.samples.books b\r\nWHERE META().id = \"68\"\r\nRETURNING b.title, b.price"}]}